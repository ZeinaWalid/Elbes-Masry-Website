const sqlite = require('sqlite3');
const db = new sqlite.Database('database.db')

const createAdminsTable =`CREATE TABLE IF NOT EXISTS ADMINS ( 
USERNAME TEXT UNIQUE NOT NULL, 
PASSWORD TEXT NOT NULL,
EMAIL TEXT UNIQUE,
ROLE TEXT DEFAULT 'admin'   
)`;

const createUsersTable =`CREATE TABLE IF NOT EXISTS USERS ( 
USER_ID INTEGER  PRIMARY KEY AUTOINCREMENT,
USERNAME TEXT UNIQUE NOT NULL, 
PASSWORD TEXT NOT NULL,
EMAIL TEXT UNIQUE NOT NULL, 
FIRST_NAME TEXT NOT NULL, 
LAST_NAME TEXT NOT NULL,
ROLE TEXT DEFAULT 'user'
)`;

const createBusinessOwnersTable = `CREATE TABLE IF NOT EXISTS BUSINESS_OWNERS (
BUSINESS_ID INTEGER PRIMARY KEY AUTOINCREMENT,
BUSINESS_USERNAME TEXT UNIQUE NOT NULL,
PASSWORD TEXT NOT NULL,
EMAIL TEXT NOT NULL,
BRAND_NAME TEXT NOT NULL UNIQUE, 
BRAND_DESCRIPTION TEXT,
ROLE TEXT DEFAULT 'business_owner'
)`;

const createProductsTable = `CREATE TABLE IF NOT EXISTS PRODUCTS (
PRODUCT_ID INTEGER PRIMARY KEY AUTOINCREMENT,
PRODUCT_NAME TEXT NOT NULL,
DESCRIPTION TEXT,
PRICE REAL NOT NULL,
SIZE TEXT,
COLOR TEXT,
STOCK INTEGER NOT NULL,
BUSINESS_ID INTEGER NOT NULL,
GENDER TEXT NOT NULL CHECK(GENDER IN ('WOMEN', 'MEN', 'KIDS', 'UNISEX')),
FOREIGN KEY (BUSINESS_ID) REFERENCES BUSINESS_OWNERS(BUSINESS_ID) ON DELETE CASCADE
)`;




const createCartTable =  `CREATE TABLE IF NOT EXISTS CART (
CART_ID INTEGER PRIMARY KEY AUTOINCREMENT,
USER_ID INTEGER NOT NULL,
PRODUCT_ID INTEGER NOT NULL,
QUANTITY INTEGER NOT NULL,
FOREIGN KEY (USER_ID) REFERENCES USERS(USER_ID) ON DELETE CASCADE,
FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCTS(PRODUCT_ID) ON DELETE CASCADE
)`;



const createOrdersTable =  `CREATE TABLE IF NOT EXISTS ORDERS (
ID INTEGER PRIMARY KEY AUTOINCREMENT,
USER_ID INT NOT NULL,
PRODUCT_ID INT NOT NULL,
QUANTITY INTEGER NOT NULL,
FOREIGN KEY (USER_ID) REFERENCES USERS(USER_ID) ON DELETE CASCADE,
FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCTS(PRODUCT_ID) ON DELETE CASCADE
)`;


module.exports= {
    db,
    createAdminsTable,
    createUsersTable,
    createProductsTable,
    createBusinessOwnersTable,
    createOrdersTable,
    createCartTable
};